name: "CI"
on:
  push:
    tags:
      - "*"

jobs:
  release:
    if: startsWith(github.ref, 'refs/tags/')
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 20
      - name: "Build Changelog"
        id: build_changelog
        uses: mikepenz/release-changelog-builder-action@v3.0.0-rc01
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      - name: "echoo0o"
        env:
          from_tag: ${{ steps.build_changelog.outputs.fromTag }}
          to_tag: ${{ steps.build_changelog.outputs.toTag }}
          changelog: ${{ steps.build_changelog.outputs.changelog }}
        run: |
          echo $from_tag
          echo $to_tag
          echo $changelog
      - name: "Complex Configuration"
        id: build_changelog2
        if: startsWith(github.ref, 'refs/tags/')
        uses: mikepenz/release-changelog-builder-action@v3.0.0-rc01
        with:
          # configuration: "configuration_complex.json"
          owner: "diyalab"
          repo: "github-actions-test"
          ignorePreReleases: "false"
          fromTag: "qa_20220511_RC10"
          toTag: "qa_20220511_RC9"
          token: ${{ secrets.GITHUB_TOKEN }}
          commitMode: "true"
      - name: "echo"
        run: |
          echo ${{ steps.build_changelog2.outputs.changelog }}
